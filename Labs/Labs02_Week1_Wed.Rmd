---
title: "Labs 02 - Week 1 Wednesday"
author: "Yunting Chiu"
date: "`r Sys.Date()`"
output:
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Exercise 1 - Simple linear regression
a. Load the data biomass and plot HHV as a function of carbon.
```{r, message=FALSE}
library(tidymodels)
# or run in console table with "remotes::install_github("tidymodels/parsnip")"
data("biomass") # in model.data package
head(biomass)

# plot
biomass %>%
ggplot(aes(x = carbon, y = HHV)) +
  geom_point() 
```

b. Fit a simple linear regression model to the data. With HHV as the response and carbon as the predictor. Is it a good fit?
- 
```{r}
# create a model specification
linear_reg() %>%
  set_mode("regression") %>%
  set_engine("lm") -> lm_spec

# fit the model
fit(lm_spec, HHV ~ carbon, data = biomass)  -> simple_lm_fit

# see the summary table
simple_lm_fit %>%
  pluck("fit") %>%
  summary()
# another way to call summary table
# simple_lm_fit$fit %>% summary()
```

```{r}
# using `tidy` to make a table as a tibble
simple_lm_fit %>% 
  tidy()
```

```{r}
simple_lm_fit %>% 
  glance() %>%
  pull(r.squared)
```

c. Use the model to predict what the HHV of samples with carbon = 10, 20, ..., 80.
```{r}
# create a new HHV data frame
new_hhv <- tibble(carbon = seq(from = 10, to = 80, by = 10))
new_hhv

predict(simple_lm_fit, new_data = new_hhv)
```

d. Produce diagnostics plots. You can use `plot()` on the $fit object to produce some diagnostics.
```{r}
simple_lm_fit %>%
  pluck("fit") %>%
  plot()
```

# Exercise 2 - Multiple linear regression
a. Fit a linear regression model to the data. With HHV as the response and carbon and hydrogen as the predictor. How is the fit compared to the simple linear model?
```{r}
fit(lm_spec, HHV ~ carbon + hydrogen, data = biomass)  -> multiple_lm_fit

summary(multiple_lm_fit$fit)
```
```{r}
# plot
biomass %>%
ggplot(aes(x = carbon, y = HHV)) +
  geom_point() 
```

b. Fit a linear regression model to the data. With HHV as the response and all the molecules as the predictor. How is the fit compared to the previous models?
```{r}
fit(lm_spec, HHV ~ carbon + hydrogen + oxygen + nitrogen + sulfur, data = biomass)  -> full_lm_fit
summary(full_lm_fit$fit)
```

